from . import SimSyscallLibrary
from .. import SIM_PROCEDURES as P

lib = SimSyscallLibrary()
lib.set_library_names('darwin')
lib.add_all_from_dict(P['darwin_kernel'])

lib.add('open', P['posix']['open'])
lib.add('read', P['posix']['read'])
lib.add('write', P['posix']['write'])
lib.add('close', P['posix']['close'])
lib.add('exit', P['libc']['exit'])
lib.add('sigaction', P['posix']['sigaction'])
lib.add('dup', P['posix']['dup'])
lib.add('pread64', P['posix']['pread64'])
lib.add('pwrite64', P['posix']['pwrite64'])
lib.add('getuid', P['linux_kernel']['getuid'])
lib.add('getgid', P['linux_kernel']['getgid'])

lib.add_alias('exit', 'exit_group')
lib.add_alias('getuid', 'geteuid')
lib.add_alias('getgid', 'getegid')

_syscall_map = {
    0:  	"nosys",
    1:  	"exit",
    2:  	"fork",
    3:  	"read",
    4:  	"write",
    5:  	"open",
    6:  	"close",
    7:  	"wait4",
    8:  	"nosys",
    9:          "link",
    10:         "unlink",
    11:         "nosys",
    12:         "chdir",
    13:         "fchdir",
    14:         "mknod",
    15:         "chmod",
    16:         "chown",
    17:         "nosys",
    18:         "getfsstat",
    19:         "nosys",
    20:         "getpid",
    21:         "nosys",
    22:         "nosys",
    23:         "setuid",
    24:         "getuid",
    25:         "geteuid",
    26:         "ptrace",
    27:         "recvmsg",
    28:         "sendmsg",
    29:         "recvfrom",
    30:         "accept",
    31:         "getpeername",
    32:         "getsockname",
    33:         "access",
    34:         "chflags",
    35:         "fchflags",
    36:         "sync",
    37:         "kill",
    38:         "nosys",
    39:         "getppid",
    40:         "nosys",
    41:         "dup",
    42:         "pipe",
    43:         "getegid",
    44:         "profil",
    45:         "nosys",
    46:         "sigaction",
    47:         "getgid",
    48:         "sigprocmask",
    49:         "getlogin",
    50:         "setlogin",
    51:         "acct",
    52:         "sigpending",
    53:         "sigaltstack",
    54:         "ioctl",
    55:         "reboot",
    56:         "revoke",
    57:         "symlink",
    58:         "readlink",
    59:         "execve",
    60:         "umask",
    61:         "chroot",
    62:         "nosys",
    63:         "nosys",
    64:         "nosys",
    65:         "msync",
    66:         "vfork",
    67:         "nosys",
    68:         "nosys",
    69:         "nosys",
    70:         "nosys",
    71:         "nosys",
    72:         "nosys",
    73:         "munmap",
    74:         "mprotect",
    75:         "madvise",
    76:         "nosys",
    77:         "nosys",
    78:         "mincore",
    79:         "getgroups",
    80:         "setgroups",
    81:         "getpgrp",
    82:         "setpgid",
    83:         "setitimer",
    84:         "nosys",
    85:         "swapon",
    86:         "getitimer",
    87:         "nosys",
    88:         "nosys",
    89:         "getdtablesize",
    90:         "dup2",
    91:         "nosys",
    92:         "fcntl",
    93:         "select",
    94:         "nosys",
    95:         "fsync",
    96:         "setpriority",
    97:         "socket",
    98:         "connect",
    99:         "nosys",
    100:	"getpriority",
    101:	"nosys",
    102:	"nosys",
    103:	"nosys",
    104:	"bind",
    105:	"setsockopt",
    106:	"listen",
    107:	"nosys",
    108:	"nosys",
    109:	"nosys",
    110:	"nosys",
    111:	"sigsuspend",
    112:	"nosys",
    113:	"nosys",
    114:	"nosys",
    115:	"nosys",
    116:	"gettimeofday",
    117:	"getrusage",
    118:	"getsockopt",
    119:	"nosys",
    120:	"readv",
    121:	"writev",
    122:	"settimeofday",
    123:	"fchown",
    124:	"fchmod",
    125:	"nosys",
    126:	"setreuid",
    127:	"setregid",
    128:	"rename",
    129:	"nosys",
    130:	"nosys",
    131:	"flock",
    132:	"mkfifo",
    133:	"sendto",
    134:	"shutdown",
    135:	"socketpair",
    136:	"mkdir",
    137:	"rmdir",
    138:	"utimes",
    139:	"futimes",
    140:	"adjtime",
    141:	"nosys",
    142:	"gethostuuid",
    143:	"nosys",
    144:	"nosys",
    145:	"nosys",
    146:	"nosys",
    147:	"setsid",
    148:	"nosys",
    149:	"nosys",
    150:	"nosys",
    151:	"getpgid",
    152:	"setprivexec",
    153:	"pread",
    154:	"pwrite",
    155:	"nfssvc",
    156:	"nosys",
    157:	"statfs",
    158:	"fstatfs",
    159:	"unmount",
    160:	"nosys",
    161:	"getfh",
    162:	"nosys",
    163:	"nosys",
    164:	"nosys",
    165:	"quotactl",
    166:	"nosys",
    167:	"mount",
    168:	"nosys",
    169:	"csops",
    170:	"nosys",
    171:	"nosys",
    172:	"nosys",
    173:	"waitid",
    174:	"nosys",
    175:	"nosys",
    176:	"add_profil",
    177:	"nosys",
    178:	"nosys",
    179:	"nosys",
    180:	"kdebug_trace",
    181:	"setgid",
    182:	"setegid",
    183:	"seteuid",
    184:	"sigreturn",
    185:	"chud",
    186:	"nosys",
    187:	"fdatasync",
    188:	"stat",
    189:	"fstat",
    190:	"lstat",
    191:	"pathconf",
    192:	"fpathconf",
    193:	"nosys",
    194:	"getrlimit",
    195:	"setrlimit",
    196:	"getdirentries",
    197:	"mmap",
    198:	"nosys",
    199:	"off_t lseek",
    200:	"truncate",
    201:	"ftruncate",
    202:	"__sysctl",
    203:	"mlock",
    204:	"munlock",
    205:	"undelete",
    206:	"ATsocket",
    207:	"ATgetmsg",
    208:	"ATputmsg",
    209:	"ATPsndreq",
    210:	"ATPsndrsp",
    211:	"ATPgetreq",
    212:	"ATPgetrsp",
    213:	"nosys",
    214:	"nosys",
    215:	"nosys",
    216:	"mkcomplex",
    217:	"statv",
    218:	"lstatv",
    219:	"fstatv",
    220:	"getattrlist",
    221:	"setattrlist",
    222:	"getdirentriesattr",
    223:	"exchangedata",
    224:	"nosys",
    225:	"searchfs",
    226:	"delete",
    227:	"copyfile",
    228:	"fgetattrlist",
    229:	"fsetattrlist",
    230:	"poll",
    231:	"watchevent",
    232:	"waitevent",
    233:	"modwatch",
    234:	"getxattr",
    235:	"fgetxattr",
    236:	"setxattr",
    237:	"fsetxattr",
    238:	"removexattr",
    239:	"fremovexattr",
    240:	"listxattr",
    241:	"flistxattr",
    242:	"fsctl",
    243:	"initgroups",
    244:	"posix_spawn",
    245:	"ffsctl",
    246:	"nosys",
    247:	"nfsclnt",
    248:	"fhopen",
    249:	"nosys",
    250:	"minherit",
    251:	"semsys",
    252:	"msgsys",
    253:	"shmsys",
    254:	"semctl",
    255:	"semget",
    256:	"semop",
    257:	"nosys",
    258:	"msgctl",
    259:	"msgget",
    260:	"msgsnd",
    261:	"msgrcv",
    262:	"shmat",
    263:	"shmctl",
    264:	"shmdt",
    265:	"shmget",
    266:	"shm_open",
    267:	"shm_unlink",
    268:	"sem_open",
    269:	"sem_close",
    270:	"sem_unlink",
    271:	"sem_wait",
    272:	"sem_trywait",
    273:	"sem_post",
    274:	"sem_getvalue",
    275:	"sem_init",
    276:	"sem_destroy",
    277:	"open_extended",
    278:	"umask_extended",
    279:	"stat_extended",
    280:	"lstat_extended",
    281:	"fstat_extended",
    282:	"chmod_extended",
    283:	"fchmod_extended",
    284:	"access_extended",
    285:	"settid",
    286:	"gettid",
    287:	"setsgroups",
    288:	"getsgroups",
    289:	"setwgroups",
    290:	"getwgroups",
    291:	"mkfifo_extended",
    292:	"mkdir_extended",
    293:	"identitysvc",
    294:	"shared_region_check_np",
    295:	"shared_region_map_np",
    296:	"vm_pressure_monitor",
    297:	"psynch_rw_longrdlock",
    298:	"psynch_rw_yieldwrlock",
    299:	"psynch_rw_downgrade",
    300:	"psynch_rw_upgrade",
    301:	"psynch_mutexwait",
    302:	"psynch_mutexdrop",
    303:	"psynch_cvbroad",
    304:	"psynch_cvsignal",
    305:	"psynch_cvwait",
    306:	"psynch_rw_rdlock",
    307:	"psynch_rw_wrlock",
    308:	"psynch_rw_unlock",
    309:	"psynch_rw_unlock2",
    310:	"getsid",
    311:	"settid_with_pid",
    312:	"nosys",
    313:	"aio_fsync",
    314:	"aio_return",
    315:	"aio_suspend",
    316:	"aio_cancel",
    317:	"aio_error",
    318:	"aio_read",
    319:	"aio_write",
    320:	"lio_listio",
    321:	"nosys",
    322:	"iopolicysys",
    323:	"nosys",
    324:	"mlockall",
    325:	"munlockall",
    326:	"nosys",
    327:	"issetugid",
    328:	"__pthread_kill",
    329:	"__pthread_sigmask",
    330:	"__sigwait",
    331:	"__disable_threadsignal",
    332:	"__pthread_markcancel",
    333:	"__pthread_canceled",
    334:        "__semwait_signal",
    335:	"nosys",
    336:	"proc_info",
    337:	"sendfile",
    338:	"stat64",
    339:	"fstat64",
    340:	"lstat64",
    341:	"stat64_extended",
    342:	"lstat64_extended",
    343:	"fstat64_extended",
    344:	"getdirentries64",
    345:	"statfs64",
    346:	"fstatfs64",
    347:	"getfsstat64",
    348:	"__pthread_chdir",
    349:	"__pthread_fchdir",
    350:	"audit",
    351:	"auditon",
    352:	"nosys",
    353:	"getauid",
    354:	"setauid",
    355:	"getaudit",
    356:	"setaudit",
    357:	"getaudit_addr",
    358:	"setaudit_addr",
    359:	"auditctl",
    360:	"bsdthread_create",
    361:	"bsdthread_terminate",
    362:	"kqueue",
    363:	"kevent",
    364:	"lchown",
    365:	"stack_snapshot",
    366:	"bsdthread_register",
    367:	"workq_open",
    368:	"workq_kernreturn",
    369:	"kevent64",
    370:        "__old_semwait_signal",
    371:        "__old_semwait_signal_nocancel",
    372:	"thread_selfid ",
    373:	"nosys",
    374:	"nosys",
    375:	"nosys",
    376:	"nosys",
    377:	"nosys",
    378:	"nosys",
    379:	"nosys",
    380:	"__mac_execve",
    381:	"__mac_syscall",
    382:	"__mac_get_file",
    383:	"__mac_set_file",
    384:	"__mac_get_link",
    385:	"__mac_set_link",
    386:	"__mac_get_proc",
    387:	"__mac_set_proc",
    388:	"__mac_get_fd",
    389:	"__mac_set_fd",
    390:	"__mac_get_pid",
    391:	"__mac_get_lcid",
    392:	"__mac_get_lctx",
    393:	"__mac_set_lctx",
    394:	"setlcid",
    395:	"getlcid",
    396:	"read_nocancel",
    397:	"write_nocancel",
    398:	"open_nocancel",
    399:	"close_nocancel",
    400:	"wait4_nocancel",
    401:	"recvmsg_nocancel",
    402:	"sendmsg_nocancel",
    403:	"recvfrom_nocancel",
    404:	"accept_nocancel",
    405:	"msync_nocancel",
    406:	"fcntl_nocancel",
    407:	"select_nocancel",
    408:	"fsync_nocancel",
    409:	"connect_nocancel",
    410:	"sigsuspend_nocancel",
    411:	"readv_nocancel",
    412:	"writev_nocancel",
    413:	"sendto_nocancel",
    414:	"pread_nocancel",
    415:	"pwrite_nocancel",
    416:	"waitid_nocancel",
    417:	"poll_nocancel",
    418:	"msgsnd_nocancel",
    419:	"msgrcv_nocancel",
    420:	"sem_wait_nocancel",
    421:	"aio_suspend_nocancel",
    422:	"__sigwait_nocancel",
    423:        "__semwait_signal_nocancel",
    424:	"__mac_mount",
    425:	"__mac_get_mount",
    426:	"__mac_getfsstat",
    427:	"fsgetpath",
    428:	"audit_session_self",
    429:	"audit_session_join",


    0x1000000:  'kern_invalid',
    0x1000001:  'kern_invalid',
    0x1000002:  'kern_invalid',
    0x1000003:  'kern_invalid',
    0x1000004:  'kern_invalid',
    0x1000005:  'kern_invalid',
    0x1000006:  'kern_invalid',
    0x1000007:  'kern_invalid',
    0x1000008:  'kern_invalid',
    0x1000009:  'kern_invalid',
    0x100000a:  'kern_invalid',
    0x100000b:  'kern_invalid',
    0x100000c:  'kern_invalid',
    0x100000d:  'kern_invalid',
    0x100000e:  'kern_invalid',
    0x100000f:  'kern_invalid',
    0x1000010:  'kern_invalid',
    0x1000011:  'kern_invalid',
    0x1000012:  'kern_invalid',
    0x1000013:  'kern_invalid',
    0x1000014:  'kern_invalid',
    0x1000015:  'kern_invalid',
    0x1000016:  'kern_invalid',
    0x1000017:  'kern_invalid',
    0x1000018:  'kern_invalid',
    0x1000019:  'kern_invalid',
    0x100001a:  'mach_reply_port',
    0x100001b:  'mach_thread_self',
    0x100001c:  'mach_task_self',
    0x100001d:  'mach_host_self',
    0x100001e:  'kern_invalid',
    0x100001f:  'mash_msg',
    0x1000020:  'mach_msg_overwrite',
    0x1000021:  'semaphore_signal',
    0x1000022:  'semaphore_signal_all',
    0x1000023:  'semaphore_signal_thread',
    0x1000024:  'semaphore_wait',
    0x1000025:  'semaphore_wait_signal',
    0x1000026:  'semaphore_timedwait',
    0x1000027:  'semaphore_timedwait_signal',
    0x1000028:  'kern_invalid',
    0x1000029:  'mach_port_guard',
    0x100002a:  'mach_port_unguard',
    0x100002b:  'mach_generate_activity_id',
    0x100002c:  'task_name_for_pid',
    0x100002d:  'task_for_pid',
    0x100002e:  'pid_for_task',
    0x100002f:  'kern_invalid',
    0x1000030:  'macx_swapon',
    0x1000031:  'macx_swapoff',
    0x1000032:  'thread_get_special_reply_port',
    0x1000033:  'macx_triggers',
    0x1000034:  'macx_backing_store_suspend',
    0x1000035:  'macx_backing_store_recovery',
    0x1000035:  'kern_invalid',
    0x1000036:  'kern_invalid',
    0x1000037:  'kern_invalid',
    0x1000038:  'kern_invalid',
    0x1000039:  'kern_invalid',
    0x100003a:  'pfz_exit',
    0x100003b:  'swtch_pri',
    0x100003c:  'swtch',
    0x100003d:  'thread_switch',
    0x100003e:  'clock_sleep',
    0x100003f:  'kern_invalid',
    0x1000040:  'kern_invalid',
    0x1000041:  'kern_invalid',
    0x1000042:  'kern_invalid',
    0x1000043:  'kern_invalid',
    0x1000044:  'kern_invalid',
    0x1000045:  'kern_invalid',
    0x1000045:  'kern_invalid',
    0x1000046:  'host_create_mach_voucer',
    0x1000047:  'kern_invalid',
    0x1000048:  'mach_voucher_extract_attr_recipe',
    0x1000049:  'kern_invalid',
    0x100004a:  'kern_invalid',
    0x100004b:  'kern_invalid',
    0x100004c:  'kern_invalid',
    0x100004d:  'kern_invalid',
    0x100004e:  'kern_invalid',
    0x100004f:  'kern_invalid',
    0x1000050:  'kern_invalid',
    0x1000051:  'kern_invalid',
    0x1000052:  'kern_invalid',
    0x1000053:  'kern_invalid',
    0x1000054:  'kern_invalid',
    0x1000055:  'kern_invalid',
    0x1000055:  'kern_invalid',
    0x1000056:  'kern_invalid',
    0x1000057:  'kern_invalid',
    0x1000058:  'kern_invalid',
    0x1000059:  'mach_timebase_info',
    0x100005a:  'mach_wait_until',
    0x100005b:  'mk_timer_create',
    0x100005c:  'mk_timer_destroy',
    0x100005d:  'mk_timer_arm',
    0x100005e:  'mk_timer_cancel',
    0x100005f:  'mk_timer_arm_leeway',
    0x1000060:  'kern_invalid',
    0x1000061:  'kern_invalid',
    0x1000062:  'kern_invalid',
    0x1000063:  'kern_invalid',
    0x1000064:  'iokit_user_client',
    0x1000065:  'kern_invalid',
    0x1000065:  'kern_invalid',
    0x1000066:  'kern_invalid',
    0x1000067:  'kern_invalid',
    0x1000068:  'kern_invalid',
    0x1000069:  'kern_invalid',
    0x100006a:  'kern_invalid',
    0x100006b:  'kern_invalid',
    0x100006c:  'kern_invalid',
    0x100006d:  'kern_invalid',
    0x100006e:  'kern_invalid',
    0x100006f:  'kern_invalid',
    0x1000070:  'kern_invalid',
    0x1000071:  'kern_invalid',
    0x1000072:  'kern_invalid',
    0x1000073:  'kern_invalid',
    0x1000074:  'kern_invalid',
    0x1000075:  'kern_invalid',
    0x1000075:  'kern_invalid',
    0x1000076:  'kern_invalid',
    0x1000077:  'kern_invalid',
    0x1000078:  'kern_invalid',
    0x1000079:  'kern_invalid',
    0x100007a:  'kern_invalid',
    0x100007b:  'kern_invalid',
    0x100007c:  'kern_invalid',
    0x100007d:  'kern_invalid',
    0x100007e:  'kern_invalid',
    0x100007f:  'kern_invalid',
}

lib.add_number_mapping_from_dict("aarch64", _syscall_map)
lib.add_number_mapping_from_dict("amd64", _syscall_map)
