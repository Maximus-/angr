from . import SimSyscallLibrary
from .. import SIM_PROCEDURES as P

lib = SimSyscallLibrary()
lib.set_library_names('darwin')
lib.add_all_from_dict(P['darwin_kernel'])

lib.add('open', P['posix']['open'])
lib.add('read', P['posix']['read'])
lib.add('write', P['posix']['write'])
lib.add('close', P['posix']['close'])
lib.add('exit', P['libc']['exit'])
lib.add('sigaction', P['posix']['sigaction'])
lib.add('dup', P['posix']['dup'])
lib.add('pread64', P['posix']['pread64'])
lib.add('pwrite64', P['posix']['pwrite64'])
lib.add('getuid', P['linux_kernel']['getuid'])
lib.add('getgid', P['linux_kernel']['getgid'])

lib.add_alias('getuid', 'geteuid')
lib.add_alias('getgid', 'getegid')

_syscall_map = {

    # 0 << 24: Invalid
    # 1 << 24: Mach
    # 2 << 24: BSD
    # 3 << 24: MDEP
    # 4 << 24: Diagnostics
    # 5 << 24: IPC

    0x1000000:  'kern_invalid',
    0x1000001:  'kern_invalid',
    0x1000002:  'kern_invalid',
    0x1000003:  'kern_invalid',
    0x1000004:  'kern_invalid',
    0x1000005:  'kern_invalid',
    0x1000006:  'kern_invalid',
    0x1000007:  'kern_invalid',
    0x1000008:  'kern_invalid',
    0x1000009:  'kern_invalid',
    0x100000a:  'kern_invalid',
    0x100000b:  'kern_invalid',
    0x100000c:  'kern_invalid',
    0x100000d:  'kern_invalid',
    0x100000e:  'kern_invalid',
    0x100000f:  'kern_invalid',
    0x1000010:  'kern_invalid',
    0x1000011:  'kern_invalid',
    0x1000012:  'kern_invalid',
    0x1000013:  'kern_invalid',
    0x1000014:  'kern_invalid',
    0x1000015:  'kern_invalid',
    0x1000016:  'kern_invalid',
    0x1000017:  'kern_invalid',
    0x1000018:  'kern_invalid',
    0x1000019:  'kern_invalid',
    0x100001a:  'mach_reply_port',
    0x100001b:  'mach_thread_self',
    0x100001c:  'mach_task_self',
    0x100001d:  'mach_host_self',
    0x100001e:  'kern_invalid',
    0x100001f:  'mash_msg',
    0x1000020:  'mach_msg_overwrite',
    0x1000021:  'semaphore_signal',
    0x1000022:  'semaphore_signal_all',
    0x1000023:  'semaphore_signal_thread',
    0x1000024:  'semaphore_wait',
    0x1000025:  'semaphore_wait_signal',
    0x1000026:  'semaphore_timedwait',
    0x1000027:  'semaphore_timedwait_signal',
    0x1000028:  'kern_invalid',
    0x1000029:  'mach_port_guard',
    0x100002a:  'mach_port_unguard',
    0x100002b:  'mach_generate_activity_id',
    0x100002c:  'task_name_for_pid',
    0x100002d:  'task_for_pid',
    0x100002e:  'pid_for_task',
    0x100002f:  'kern_invalid',
    0x1000030:  'macx_swapon',
    0x1000031:  'macx_swapoff',
    0x1000032:  'thread_get_special_reply_port',
    0x1000033:  'macx_triggers',
    0x1000034:  'macx_backing_store_suspend',
    0x1000035:  'macx_backing_store_recovery',
    0x1000035:  'kern_invalid',
    0x1000036:  'kern_invalid',
    0x1000037:  'kern_invalid',
    0x1000038:  'kern_invalid',
    0x1000039:  'kern_invalid',
    0x100003a:  'pfz_exit',
    0x100003b:  'swtch_pri',
    0x100003c:  'swtch',
    0x100003d:  'thread_switch',
    0x100003e:  'clock_sleep',
    0x100003f:  'kern_invalid',
    0x1000040:  'kern_invalid',
    0x1000041:  'kern_invalid',
    0x1000042:  'kern_invalid',
    0x1000043:  'kern_invalid',
    0x1000044:  'kern_invalid',
    0x1000045:  'kern_invalid',
    0x1000045:  'kern_invalid',
    0x1000046:  'host_create_mach_voucer',
    0x1000047:  'kern_invalid',
    0x1000048:  'mach_voucher_extract_attr_recipe',
    0x1000049:  'kern_invalid',
    0x100004a:  'kern_invalid',
    0x100004b:  'kern_invalid',
    0x100004c:  'kern_invalid',
    0x100004d:  'kern_invalid',
    0x100004e:  'kern_invalid',
    0x100004f:  'kern_invalid',
    0x1000050:  'kern_invalid',
    0x1000051:  'kern_invalid',
    0x1000052:  'kern_invalid',
    0x1000053:  'kern_invalid',
    0x1000054:  'kern_invalid',
    0x1000055:  'kern_invalid',
    0x1000055:  'kern_invalid',
    0x1000056:  'kern_invalid',
    0x1000057:  'kern_invalid',
    0x1000058:  'kern_invalid',
    0x1000059:  'mach_timebase_info',
    0x100005a:  'mach_wait_until',
    0x100005b:  'mk_timer_create',
    0x100005c:  'mk_timer_destroy',
    0x100005d:  'mk_timer_arm',
    0x100005e:  'mk_timer_cancel',
    0x100005f:  'mk_timer_arm_leeway',
    0x1000060:  'kern_invalid',
    0x1000061:  'kern_invalid',
    0x1000062:  'kern_invalid',
    0x1000063:  'kern_invalid',
    0x1000064:  'iokit_user_client',
    0x1000065:  'kern_invalid',
    0x1000065:  'kern_invalid',
    0x1000066:  'kern_invalid',
    0x1000067:  'kern_invalid',
    0x1000068:  'kern_invalid',
    0x1000069:  'kern_invalid',
    0x100006a:  'kern_invalid',
    0x100006b:  'kern_invalid',
    0x100006c:  'kern_invalid',
    0x100006d:  'kern_invalid',
    0x100006e:  'kern_invalid',
    0x100006f:  'kern_invalid',
    0x1000070:  'kern_invalid',
    0x1000071:  'kern_invalid',
    0x1000072:  'kern_invalid',
    0x1000073:  'kern_invalid',
    0x1000074:  'kern_invalid',
    0x1000075:  'kern_invalid',
    0x1000075:  'kern_invalid',
    0x1000076:  'kern_invalid',
    0x1000077:  'kern_invalid',
    0x1000078:  'kern_invalid',
    0x1000079:  'kern_invalid',
    0x100007a:  'kern_invalid',
    0x100007b:  'kern_invalid',
    0x100007c:  'kern_invalid',
    0x100007d:  'kern_invalid',
    0x100007e:  'kern_invalid',
    0x100007f:  'kern_invalid',

    0x2000000:  "nosys",
    0x2000001: 	"exit",
    0x2000002: 	"fork",
    0x2000003: 	"read",
    0x2000004: 	"write",
    0x2000005: 	"open",
    0x2000006: 	"close",
    0x2000007: 	"wait4",
    0x2000008:  "nosys",
    0x2000009:  "link",
    0x200000a:  "unlink",
    0x200000b:  "nosys",
    0x200000c:  "chdir",
    0x200000d:  "fchdir",
    0x200000e:  "mknod",
    0x200000f:  "chmod",
    0x2000010:  "chown",
    0x2000011:  "nosys",
    0x2000012:  "getfsstat",
    0x2000013:  "nosys",
    0x2000014:  "getpid",
    0x2000015:  "nosys",
    0x2000016:  "nosys",
    0x2000017:  "setuid",
    0x2000018:  "getuid",
    0x2000019:  "geteuid",
    0x200001a:  "ptrace",
    0x200001b:  "recvmsg",
    0x200001c:  "sendmsg",
    0x200001d:  "recvfrom",
    0x200001e:  "accept",
    0x200001f:  "getpeername",
    0x2000020:  "getsockname",
    0x2000021:  "access",
    0x2000022:  "chflags",
    0x2000023:  "fchflags",
    0x2000024:  "sync",
    0x2000025:  "kill",
    0x2000026:  "nosys",
    0x2000027:  "getppid",
    0x2000028:  "nosys",
    0x2000029:  "dup",
    0x200002a:  "pipe",
    0x200002b:  "getegid",
    0x200002c:  "profil",
    0x200002d:  "nosys",
    0x200002e:  "sigaction",
    0x200002f:  "getgid",
    0x2000030:  "sigprocmask",
    0x2000031:  "getlogin",
    0x2000032:  "setlogin",
    0x2000033:  "acct",
    0x2000034:  "sigpending",
    0x2000035:  "sigaltstack",
    0x2000036:  "ioctl",
    0x2000037:  "reboot",
    0x2000038:  "revoke",
    0x2000039:  "symlink",
    0x200003a:  "readlink",
    0x200003b:  "execve",
    0x200003c:  "umask",
    0x200003d:  "chroot",
    0x200003e:  "nosys",
    0x200003f:  "nosys",
    0x2000040:  "nosys",
    0x2000041:  "msync",
    0x2000042:  "vfork",
    0x2000043:  "nosys",
    0x2000044:  "nosys",
    0x2000045:  "nosys",
    0x2000046:  "nosys",
    0x2000047:  "nosys",
    0x2000048:  "nosys",
    0x2000049:  "munmap",
    0x200004a:  "mprotect",
    0x200004b:  "madvise",
    0x200004c:  "nosys",
    0x200004d:  "nosys",
    0x200004e:  "mincore",
    0x200004f:  "getgroups",
    0x2000050:  "setgroups",
    0x2000051:  "getpgrp",
    0x2000052:  "setpgid",
    0x2000053:  "setitimer",
    0x2000054:  "nosys",
    0x2000055:  "swapon",
    0x2000056:  "getitimer",
    0x2000057:  "nosys",
    0x2000058:  "nosys",
    0x2000059:  "getdtablesize",
    0x200005a:  "dup2",
    0x200005b:  "nosys",
    0x200005c:  "fcntl",
    0x200005d:  "select",
    0x200005e:  "nosys",
    0x200005f:  "fsync",
    0x2000060:  "setpriority",
    0x2000061:  "socket",
    0x2000062:  "connect",
    0x2000063:  "nosys",
    0x2000064:	"getpriority",
    0x2000065:	"nosys",
    0x2000066:	"nosys",
    0x2000067:	"nosys",
    0x2000068:	"bind",
    0x2000069:	"setsockopt",
    0x200006a:	"listen",
    0x200006b:	"nosys",
    0x200006c:	"nosys",
    0x200006d:	"nosys",
    0x200006e:	"nosys",
    0x200006f:	"sigsuspend",
    0x2000070:	"nosys",
    0x2000071:	"nosys",
    0x2000072:	"nosys",
    0x2000073:	"nosys",
    0x2000074:	"gettimeofday",
    0x2000075:	"getrusage",
    0x2000076:	"getsockopt",
    0x2000077:	"nosys",
    0x2000078:	"readv",
    0x2000079:	"writev",
    0x200007a:	"settimeofday",
    0x200007b:	"fchown",
    0x200007c:	"fchmod",
    0x200007d:	"nosys",
    0x200007e:	"setreuid",
    0x200007f:	"setregid",
    0x2000080:	"rename",
    0x2000081:	"nosys",
    0x2000082:	"nosys",
    0x2000083:	"flock",
    0x2000084:	"mkfifo",
    0x2000085:	"sendto",
    0x2000086:	"shutdown",
    0x2000087:	"socketpair",
    0x2000088:	"mkdir",
    0x2000089:	"rmdir",
    0x200008a:	"utimes",
    0x200008b:	"futimes",
    0x200008c:	"adjtime",
    0x200008d:	"nosys",
    0x200008e:	"gethostuuid",
    0x200008f:	"nosys",
    0x2000090:	"nosys",
    0x2000091:	"nosys",
    0x2000092:	"nosys",
    0x2000093:	"setsid",
    0x2000094:	"nosys",
    0x2000095:	"nosys",
    0x2000096:	"nosys",
    0x2000097:	"getpgid",
    0x2000098:	"setprivexec",
    0x2000099:	"pread",
    0x200009a:	"pwrite",
    0x200009b:	"nfssvc",
    0x200009c:	"nosys",
    0x200009d:	"statfs",
    0x200009e:	"fstatfs",
    0x200009f:	"unmount",
    0x20000a0:	"nosys",
    0x20000a1:	"getfh",
    0x20000a2:	"nosys",
    0x20000a3:	"nosys",
    0x20000a4:	"nosys",
    0x20000a5:	"quotactl",
    0x20000a6:	"nosys",
    0x20000a7:	"mount",
    0x20000a8:	"nosys",
    0x20000a9:	"csops",
    0x20000aa:	"nosys",
    0x20000ab:	"nosys",
    0x20000ac:	"nosys",
    0x20000ad:	"waitid",
    0x20000ae:	"nosys",
    0x20000af:	"nosys",
    0x20000b0:	"add_profil",
    0x20000b1:	"nosys",
    0x20000b2:	"nosys",
    0x20000b3:	"nosys",
    0x20000b4:	"kdebug_trace",
    0x20000b5:	"setgid",
    0x20000b6:	"setegid",
    0x20000b7:	"seteuid",
    0x20000b8:	"sigreturn",
    0x20000b9:	"chud",
    0x20000ba:	"nosys",
    0x20000bb:	"fdatasync",
    0x20000bc:	"stat",
    0x20000bd:	"fstat",
    0x20000be:	"lstat",
    0x20000bf:	"pathconf",
    0x20000c0:	"fpathconf",
    0x20000c1:	"nosys",
    0x20000c2:	"getrlimit",
    0x20000c3:	"setrlimit",
    0x20000c4:	"getdirentries",
    0x20000c5:	"mmap",
    0x20000c6:	"nosys",
    0x20000c7:	"off_t lseek",
    0x20000c8:	"truncate",
    0x20000c9:	"ftruncate",
    0x20000ca:	"__sysctl",
    0x20000cb:	"mlock",
    0x20000cc:	"munlock",
    0x20000cd:	"undelete",
    0x20000ce:	"ATsocket",
    0x20000cf:	"ATgetmsg",
    0x20000d0:	"ATputmsg",
    0x20000d1:	"ATPsndreq",
    0x20000d2:	"ATPsndrsp",
    0x20000d3:	"ATPgetreq",
    0x20000d4:	"ATPgetrsp",
    0x20000d5:	"nosys",
    0x20000d6:	"nosys",
    0x20000d7:	"nosys",
    0x20000d8:	"mkcomplex",
    0x20000d9:	"statv",
    0x20000da:	"lstatv",
    0x20000db:	"fstatv",
    0x20000dc:	"getattrlist",
    0x20000dd:	"setattrlist",
    0x20000de:	"getdirentriesattr",
    0x20000df:	"exchangedata",
    0x20000e0:	"nosys",
    0x20000e1:	"searchfs",
    0x20000e2:	"delete",
    0x20000e3:	"copyfile",
    0x20000e4:	"fgetattrlist",
    0x20000e5:	"fsetattrlist",
    0x20000e6:	"poll",
    0x20000e7:	"watchevent",
    0x20000e8:	"waitevent",
    0x20000e9:	"modwatch",
    0x20000ea:	"getxattr",
    0x20000eb:	"fgetxattr",
    0x20000ec:	"setxattr",
    0x20000ed:	"fsetxattr",
    0x20000ee:	"removexattr",
    0x20000ef:	"fremovexattr",
    0x20000f0:	"listxattr",
    0x20000f1:	"flistxattr",
    0x20000f2:	"fsctl",
    0x20000f3:	"initgroups",
    0x20000f4:	"posix_spawn",
    0x20000f5:	"ffsctl",
    0x20000f6:	"nosys",
    0x20000f7:	"nfsclnt",
    0x20000f8:	"fhopen",
    0x20000f9:	"nosys",
    0x20000fa:	"minherit",
    0x20000fb:	"semsys",
    0x20000fc:	"msgsys",
    0x20000fd:	"shmsys",
    0x20000fe:	"semctl",
    0x20000ff:	"semget",
    0x2000100:	"semop",
    0x2000101:	"nosys",
    0x2000102:	"msgctl",
    0x2000103:	"msgget",
    0x2000104:	"msgsnd",
    0x2000105:	"msgrcv",
    0x2000106:	"shmat",
    0x2000107:	"shmctl",
    0x2000108:	"shmdt",
    0x2000109:	"shmget",
    0x200010a:	"shm_open",
    0x200010b:	"shm_unlink",
    0x200010c:	"sem_open",
    0x200010d:	"sem_close",
    0x200010e:	"sem_unlink",
    0x200010f:	"sem_wait",
    0x2000110:	"sem_trywait",
    0x2000111:	"sem_post",
    0x2000112:	"sem_getvalue",
    0x2000113:	"sem_init",
    0x2000114:	"sem_destroy",
    0x2000115:	"open_extended",
    0x2000116:	"umask_extended",
    0x2000117:	"stat_extended",
    0x2000118:	"lstat_extended",
    0x2000119:	"fstat_extended",
    0x200011a:	"chmod_extended",
    0x200011b:	"fchmod_extended",
    0x200011c:	"access_extended",
    0x200011d:	"settid",
    0x200011e:	"gettid",
    0x200011f:	"setsgroups",
    0x2000120:	"getsgroups",
    0x2000121:	"setwgroups",
    0x2000122:	"getwgroups",
    0x2000123:	"mkfifo_extended",
    0x2000124:	"mkdir_extended",
    0x2000125:	"identitysvc",
    0x2000126:	"shared_region_check_np",
    0x2000127:	"shared_region_map_np",
    0x2000128:	"vm_pressure_monitor",
    0x2000129:	"psynch_rw_longrdlock",
    0x200012a:	"psynch_rw_yieldwrlock",
    0x200012b:	"psynch_rw_downgrade",
    0x200012c:	"psynch_rw_upgrade",
    0x200012d:	"psynch_mutexwait",
    0x200012e:	"psynch_mutexdrop",
    0x200012f:	"psynch_cvbroad",
    0x2000130:	"psynch_cvsignal",
    0x2000131:	"psynch_cvwait",
    0x2000132:	"psynch_rw_rdlock",
    0x2000133:	"psynch_rw_wrlock",
    0x2000134:	"psynch_rw_unlock",
    0x2000135:	"psynch_rw_unlock2",
    0x2000136:	"getsid",
    0x2000137:	"settid_with_pid",
    0x2000138:	"nosys",
    0x2000139:	"aio_fsync",
    0x200013a:	"aio_return",
    0x200013b:	"aio_suspend",
    0x200013c:	"aio_cancel",
    0x200013d:	"aio_error",
    0x200013e:	"aio_read",
    0x200013f:	"aio_write",
    0x2000140:	"lio_listio",
    0x2000141:	"nosys",
    0x2000142:	"iopolicysys",
    0x2000143:	"nosys",
    0x2000144:	"mlockall",
    0x2000145:	"munlockall",
    0x2000146:	"nosys",
    0x2000147:	"issetugid",
    0x2000148:	"__pthread_kill",
    0x2000149:	"__pthread_sigmask",
    0x200014a:	"__sigwait",
    0x200014b:	"__disable_threadsignal",
    0x200014c:	"__pthread_markcancel",
    0x200014d:	"__pthread_canceled",
    0x200014e:    " __semwait_signal",
    0x200014f:	"nosys",
    0x2000150:	"proc_info",
    0x2000151:	"sendfile",
    0x2000152:	"stat64",
    0x2000153:	"fstat64",
    0x2000154:	"lstat64",
    0x2000155:	"stat64_extended",
    0x2000156:	"lstat64_extended",
    0x2000157:	"fstat64_extended",
    0x2000158:	"getdirentries64",
    0x2000159:	"statfs64",
    0x200015a:	"fstatfs64",
    0x200015b:	"getfsstat64",
    0x200015c:	"__pthread_chdir",
    0x200015d:	"__pthread_fchdir",
    0x200015e:	"audit",
    0x200015f:	"auditon",
    0x2000160:	"nosys",
    0x2000161:	"getauid",
    0x2000162:	"setauid",
    0x2000163:	"getaudit",
    0x2000164:	"setaudit",
    0x2000165:	"getaudit_addr",
    0x2000166:	"setaudit_addr",
    0x2000167:	"auditctl",
    0x2000168:	"bsdthread_create",
    0x2000169:	"bsdthread_terminate",
    0x200016a:	"kqueue",
    0x200016b:	"kevent",
    0x200016c:	"lchown",
    0x200016d:	"stack_snapshot",
    0x200016e:	"bsdthread_register",
    0x200016f:	"workq_open",
    0x2000170:	"workq_kernreturn",
    0x2000171:	"kevent64",
    0x2000172:    "__old_semwait_signal",
    0x2000173:    "__old_semwait_signal_nocancel",
    0x2000174:	"thread_selfid ",
    0x2000175:	"nosys",
    0x2000176:	"nosys",
    0x2000177:	"nosys",
    0x2000178:	"nosys",
    0x2000179:	"nosys",
    0x200017a:	"nosys",
    0x200017b:	"nosys",
    0x200017c:	"__mac_execve",
    0x200017d:	"__mac_syscall",
    0x200017e:	"__mac_get_file",
    0x200017f:	"__mac_set_file",
    0x2000180:	"__mac_get_link",
    0x2000181:	"__mac_set_link",
    0x2000182:	"__mac_get_proc",
    0x2000183:	"__mac_set_proc",
    0x2000184:	"__mac_get_fd",
    0x2000185:	"__mac_set_fd",
    0x2000186:	"__mac_get_pid",
    0x2000187:	"__mac_get_lcid",
    0x2000188:	"__mac_get_lctx",
    0x2000189:	"__mac_set_lctx",
    0x200018a:	"setlcid",
    0x200018b:	"getlcid",
    0x200018c:	"read_nocancel",
    0x200018d:	"write_nocancel",
    0x200018e:	"open_nocancel",
    0x200018f:	"close_nocancel",
    0x2000190:	"wait4_nocancel",
    0x2000191:	"recvmsg_nocancel",
    0x2000192:	"sendmsg_nocancel",
    0x2000193:	"recvfrom_nocancel",
    0x2000194:	"accept_nocancel",
    0x2000195:	"msync_nocancel",
    0x2000196:	"fcntl_nocancel",
    0x2000197:	"select_nocancel",
    0x2000198:	"fsync_nocancel",
    0x2000199:	"connect_nocancel",
    0x200019a:	"sigsuspend_nocancel",
    0x200019b:	"readv_nocancel",
    0x200019c:	"writev_nocancel",
    0x200019d:	"sendto_nocancel",
    0x200019e:	"pread_nocancel",
    0x200019f:	"pwrite_nocancel",
    0x20001a0:	"waitid_nocancel",
    0x20001a1:	"poll_nocancel",
    0x20001a2:	"msgsnd_nocancel",
    0x20001a3:	"msgrcv_nocancel",
    0x20001a4:	"sem_wait_nocancel",
    0x20001a5:	"aio_suspend_nocancel",
    0x20001a6:	"__sigwait_nocancel",
    0x20001a7:    "__semwait_signal_nocancel",
    0x20001a8:	"__mac_mount",
    0x20001a9:	"__mac_get_mount",
    0x20001aa:	"__mac_getfsstat",
    0x20001ab:	"fsgetpath",
    0x20001ac:	"audit_session_self",
    0x20001ad:	"audit_session_join",
}

lib.add_number_mapping_from_dict("aarch64", _syscall_map)
lib.add_number_mapping_from_dict("amd64", _syscall_map)

